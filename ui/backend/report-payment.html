
<!DOCTYPE html>
<html lang="en">
	<!--begin::Head-->
	<head><base href="../../../">
		<meta charset="utf-8" />
		<title>ລາຍງານ | ລາຍງານຈ່າຍຄ່າເທີມ</title>
		<meta name="description" content="Child datatable from local data" />
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
		<include href="backend/inc/header.html" />
	</head>
	<!--end::Head-->
	<!--begin::Body-->
	<body id="kt_body" class="header-fixed header-mobile-fixed subheader-enabled page-loading">
		<!--begin::Main-->
		<!--begin::Header Mobile-->
		<div id="kt_header_mobile" class="header-mobile bg-primary header-mobile-fixed">
			<!--begin::Logo-->
			<a href="{{@BASE}}/">
				<img alt="Logo" src="{{@BASE}}/ui/backend/assets/media/logos/logo-letter-9.png" class="max-h-30px" />
			</a>
			<!--end::Logo-->
			<!--begin::Toolbar-->
			<div class="d-flex align-items-center">
				<button class="btn p-0 burger-icon burger-icon-left ml-4" id="kt_header_mobile_toggle">
					<span></span>
				</button>
				<button class="btn p-0 ml-2" id="kt_header_mobile_topbar_toggle">
					<span class="svg-icon svg-icon-xl">
						<!--begin::Svg Icon | path:assets/media/svg/icons/General/user.svg-->
						<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
							<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
								<polygon points="0 0 24 0 24 24 0 24" />
								<path d="M12,11 C9.790861,11 8,9.209139 8,7 C8,4.790861 9.790861,3 12,3 C14.209139,3 16,4.790861 16,7 C16,9.209139 14.209139,11 12,11 Z" fill="#000000" fill-rule="nonzero" opacity="0.3" />
								<path d="M3.00065168,20.1992055 C3.38825852,15.4265159 7.26191235,13 11.9833413,13 C16.7712164,13 20.7048837,15.2931929 20.9979143,20.2 C21.0095879,20.3954741 20.9979143,21 20.2466999,21 C16.541124,21 11.0347247,21 3.72750223,21 C3.47671215,21 2.97953825,20.45918 3.00065168,20.1992055 Z" fill="#000000" fill-rule="nonzero" />
							</g>
						</svg>
						<!--end::Svg Icon-->
					</span>
				</button>
			</div>
			<!--end::Toolbar-->
		</div>
		<!--end::Header Mobile-->
		<div class="d-flex flex-column flex-root">
			<!--begin::Page-->
			<div class="d-flex flex-row flex-column-fluid page">
				<!--begin::Wrapper-->
				<div class="d-flex flex-column flex-row-fluid wrapper" id="kt_wrapper">
					<!--begin::Header-->
					<div id="kt_header" class="header flex-column header-fixed">
						<!--begin::Top-->
                        <include href="backend/inc/topnav.html" />
						<!--end::Top-->
						<!--begin::Bottom-->
						<include href="backend/inc/nav.html" />
						<!--end::Bottom-->
					</div>
					<!--end::Header-->
					<!--begin::Content-->
					<div class="content d-flex flex-column flex-column-fluid" id="kt_content">
						<!--begin::Subheader-->
						<div class="subheader py-2 py-lg-6 subheader-transparent" id="kt_subheader">
							<div class="container d-flex align-items-center justify-content-between flex-wrap flex-sm-nowrap">
								<!--begin::Info-->
								<div class="d-flex align-items-center flex-wrap mr-1">
									<!--begin::Page Heading-->
									<div class="d-flex align-items-baseline flex-wrap mr-5">
										<!--begin::Page Title-->
										
										<!--end::Breadcrumb-->
									</div>
									<!--end::Page Heading-->
								</div>
								<!--end::Info-->
							</div>
						</div>
						<!--end::Subheader-->
						<!--begin::Entry-->
						<div class="d-flex flex-column-fluid">
							<!--begin::Container-->
							<div class="container-fluid">
								<!--begin::Card-->
								<div class="card card-custom">
									<div class="card-header flex-wrap border-0 pt-6 pb-0">
										<div class="card-title la">
											<h3 class="card-label">{{@strPage}} ({{ @entrycount }})
											<span class="d-block text-muted pt-2 font-size-sm">{{@strAction}}</span></h3>
										</div>
									</div>
									<div class="card-body">
										<!--begin: Datatable-->
                                        <div class="table-responsive-xl" id="app">
                                            <form>
                                                <div class="row">
                                                    <div class="col-md-3 mb-2">
                                                        <select name="semester" class="form-control">
                                                            {{ @custom->renderArraySelect(@arrSemester,@semester) }}
                                                        </select>
                                                    </div>
                                                    <div class="col-md-3 mb-2">
                                                        <select name="class_id" class="form-control">
                                                            {{ @custom->renderArraySelect(@arrClass,@class_id) }}
                                                        </select>
                                                    </div>
													<div class="col-md-3 mb-2">
                                                        <select name="year" class="form-control la-normal">
															<option value="">ທັງໝົດ</option>
                                                            {{ @custom->renderArraySelect(@arrYear,@year) }}
                                                        </select>
                                                    </div>
                                                    <div class="col-md-3 mb-2">
                                                        <button class="btn btn-primary la-normal">ຕົກລົງ</button>
                                                    </div>
                                                </div>
                                            </form>
                                            <div id="print-report">
                                                <table class="table table-bordered table-striped table-sm" id="print-table">
                                                    <thead>
                                                        <tr style="font-family: NotoSerifLao;">
                                                            <th>ລຳດັບ</th>
                                                            <th>ລະຫັດ</th>
                                                            <th>ຊື່​</th>
                                                            <th>ນາມສະກຸນ</th>
                                                            <th>ຫ້ອງຮຽນ</th>
                                                            <th>ເພດ</th>
                                                            <th>ວັນເດືອນປີເກີດ</th>
                                                            <th>ເບີໂທ</th>
                                                            <th>ໝາຍເຫດ</th>
                                                            <th>ລວມ</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <repeat group="{{ @data }}" value="{{ @row }}" counter="{{ @ctr }}">
                                                            <tr id="item-{{@row.id}}">
                                                                <td>{{ @ctr }}</td>
                                                                <td>{{ @row.student_no }}</td>
                                                                <td>{{ @row.first_name }}</td>
                                                                <td>{{ @row.last_name }}</td>
                                                                <td>{{ @@row.class }}</td>
                                                                <td>{{ @row.gender }}</td>
                                                                <td>{{ @row.dob }}</td>
                                                                <td>{{ @row.phone }}</td>
                                                                <td><span class="btn {{ @row.btn }}">{{ @row.status }}</span></td>
                                                                <td align="right">{{ number_format(@row.amount) }}</td>
                                                            </tr>
                                                        </repeat>
                                                        <tr>
                                                            <td colspan="9" align="right">
                                                                <strong>ລວມທັງໝົດ</strong>
                                                            </td>
                                                            <td align="right">
                                                                <strong>{{ number_format(@total_amount) }}</strong>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                            <div align="center">
                                                <button class="btn btn-info" onclick="PrintDiv('print-report')"><i class="fa fa-print"></i></button>
                                                <button type="button" onclick="exportTableToExcel('print-table', 'excel-data')" class="btn btn-primary"><i class="fa fa-file-excel" aria-hidden="true"></i></button>
                                            </div>
                                          </div>
										<!--end: Datatable-->
									</div>
								</div>
								<!--end::Card-->
							</div>
							<!--end::Container-->
						</div>
						<!--end::Entry-->
					</div>
					<!--end::Content-->
					<!--begin::Footer-->
					<include href="backend/inc/footer.html" />
					<!--end::Footer-->
				</div>
				<!--end::Wrapper-->
			</div>
			<!--end::Page-->
		</div>
		<include href="backend/inc/panel.html"/>
		<include href="backend/inc/script.html" />
		<script>
			$(document).on('change','#class-id',function(){
				window.location.href='{{ @BASE }}/calculate-grade?class_id='+$(this).val();
			})
            function PrintDiv(id) {
                var data=document.getElementById(id).innerHTML;
                var myWindow = window.open('', 'ພີມໃບບິນ', '');
                //var myWindow = window.open('', 'my div', 'height=700,width=800');
                myWindow.document.write('<html><head><title>ພີມໃບບິນ</title>');
                var htmlToPrint = '' + '<style type="text/css">' + 'table {' + 'font-family: "Phetsarath OT"; margin-top:7px;' +'}'+'table th {' + 'font-family: "Phetsarath OT";' +'}' + '#print-table {border-collapse: collapse;width: 100%;}#print-table td, #print-table th {border: 1px solid #000000;padding: 8px;}#print-table th { padding-top: 12px;padding-bottom: 12px;text-align: left;}.text-center{text-align: center;}</style>';
                /*optional stylesheet*/ //myWindow.document.write('<link rel="stylesheet" href="main.css" type="text/css" />');
                myWindow.document.write('</head><body >');
                myWindow.document.write(data);
                myWindow.document.write('</body></html>');
                myWindow.document.write(htmlToPrint);
                myWindow.document.close(); // necessary for IE >= 1
                myWindow.onload=function(){ // necessary if the div contain images
                    myWindow.focus(); // necessary for IE >= 10
                    myWindow.print();
                    myWindow.close();
                };
            }
            function exportTableToExcel(tableID, filename = ''){
            var downloadLink;
            var dataType = 'application/vnd.ms-excel';
            var tableSelect = document.getElementById(tableID);
            var tableHTML = tableSelect.outerHTML.replace(/ /g, '%20');
            // Specify file name
            filename = filename?filename+'.xls':'excel_data.xls';
            // Create download link element
            downloadLink = document.createElement("a");
            document.body.appendChild(downloadLink);
            if(navigator.msSaveOrOpenBlob){
                var blob = new Blob(['\ufeff', tableHTML], {
                    type: dataType
                });
                navigator.msSaveOrOpenBlob( blob, filename);
            }else{
                // Create a link to the file
                downloadLink.href = 'data:' + dataType + ', ' + tableHTML;
                // Setting the file name
                downloadLink.download = filename;
                //triggering the function
                downloadLink.click();
            }
        }
		</script>
		<!--end::Page Scripts-->
	</body>
	<!--end::Body-->
</html>